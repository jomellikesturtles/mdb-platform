"use strict";(self.webpackChunkmdb_electron=self.webpackChunkmdb_electron||[]).push([[107],{7107:(w,u,n)=>{n.r(u),n.d(u,{DashboardModule:()=>$});var f=n(177),M=n(6523),m=n(2791),L=n(467),T=n(3426),g=n(4597),y=n(1891),b=n(528),I=n(3487),p=n(5832),G=n(9694),t=n(4438),N=n(8490),S=n(9211),E=n(2389),C=n(2835);function F(o,D){if(1&o&&(t.j41(0,"div"),t.nrm(1,"app-horizontal-card-list",3),t.k0s()),2&o){const e=D.$implicit;t.R7$(),t.Y8G("title",e.name)("moviesList",e.data)("seeAllLink","/discover")("queryParams",e.queryParams)("loading",e.loading)}}function R(o,D){if(1&o&&(t.j41(0,"div"),t.DNE(1,F,2,5,"div",2),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.dashboardLists)}}function Y(o,D){1&o&&(t.j41(0,"div")(1,"h1"),t.EFF(2,"You are offline"),t.k0s()())}const x=[{path:"",component:(()=>{class o{constructor(e,s,l,d,a,i){this.dataService=e,this.movieService=s,this.router=l,this.activatedRoute=d,this.loggerService=a,this.store=i,this.browserConnection=navigator.onLine,this.dashboardLists=[],this.cardWidth="130px"}ngOnInit(){this.getDashboard()}getDashboard(e=!1){this.dashboardLists=[{name:"New Releases",data:[],loading:!0},{name:"Top movies of",data:[],loading:!0},{name:"Top Genre",data:[],loading:!0}],this.getNowShowingMovies(e),this.getTopMoviesFromYear(e),this.getTopGenreMovie(e)}getNowShowingMovies(e){const s="New Releases";let l=`movie:dashboard:${s}`.toLowerCase();const d=this.store.selectSnapshot(p.i.getDashboardMovie(l)),a=this.dashboardLists.findIndex(i=>i.name===s);if(!d||e){const i=new Date,c=i.getFullYear()+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+("0"+i.getDate()).slice(-2);i.setDate(i.getDate()-21);const r=i.getFullYear()+"-"+("0"+(i.getMonth()+1)).slice(-2)+"-"+("0"+i.getDate()).slice(-2),v=new Map;v.set(g.eq.PrimaryReleaseDateGreater,r),v.set(g.eq.PrimaryReleaseDateLess,c),this.sendToMovieService(v,s,l)}else d?.movieDashboard&&(-1!==a?this.dashboardLists[a]={...d.movieDashboard,loading:!1}:this.dashboardLists.push({...d.movieDashboard,loading:!1}))}getTopMoviesFromYear(e){const s="Top movies of",l=new Date,a=Math.round(Math.random()*(l.getFullYear()-1-1940)+1940),i=`${s} ${a}`;let c=`movie:dashboard:${s}`.toLowerCase();const r=this.store.selectSnapshot(p.i.getDashboardMovie(c)),v=this.dashboardLists.findIndex(h=>h.name===s);if(!r||e){const h=new Map;h.set(g.eq.PrimaryReleaseYear,a),this.sendToMovieService(h,i,c,s)}else r?.movieDashboard&&(-1!==v?this.dashboardLists[v]={...r.movieDashboard,loading:!1}:this.dashboardLists.push({...r.movieDashboard,loading:!1}))}getTopGenreMovie(e){const s="Top Genre",d=Math.floor(19*Math.random()),a=y.DD[d],i=`Top ${a.name}`;let c=`movie:dashboard:${s}`.toLowerCase();const r=this.store.selectSnapshot(p.i.getDashboardMovie(c)),v=this.dashboardLists.findIndex(h=>h.name===s);if(!r||e){const h=new Map;h.set(g.eq.WithGenres,a.id),this.sendToMovieService(h,i,c,s)}else r?.movieDashboard&&(-1!==v?this.dashboardLists[v]={...r.movieDashboard,loading:!1}:this.dashboardLists.push({...r.movieDashboard,loading:!1}))}sendToMovieService(e,s,l,d){var a=this;return(0,L.A)(function*(){let c=(yield a.movieService.getMoviesDiscover(e,s).toPromise()).results;const r={name:s,data:c,queryParams:e,loading:!1},v=d||s,h=a.dashboardLists.findIndex(U=>U.name===v);-1!==h?a.dashboardLists[h]=r:a.dashboardLists.push(r),a.dataService.addDashboardData(r.data),a.store.dispatch(new G.EH({id:l,movieDashboard:r}))})()}getMoviesFromLibrary(){b.A.DEBUG.log("getMoviesFromLibrary dashboard.component")}goToMovie(e){const s=e;this.dataService.updateHighlightedMovie(s),this.router.navigate([`/ details / ${s}`],{relativeTo:this.activatedRoute})}scrollPrev(){const e=document.getElementById("topMoviesFromYearPanel");this.sideScroll(e,"left",25,100,10)}scrollNext(){const e=document.getElementById("topMoviesFromYearPanel");this.sideScroll(e,"right",25,100,10)}sideScroll(e,s,l,d,a){let i=0;const c=setInterval(()=>{"left"===s?e.scrollLeft-=a:e.scrollLeft+=a,i+=a,i>=d&&window.clearInterval(Number(c))},l)}getYear(e){return b.A.getYear(e)}static{this.\u0275fac=function(s){return new(s||o)(t.rXU(N.u),t.rXU(T.W),t.rXU(m.Ix),t.rXU(m.nX),t.rXU(S.g),t.rXU(I.il))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-dashboard"]],decls:4,vars:2,consts:[[1,"container-fluid",2,"padding-top","3vh"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title","moviesList","seeAllLink","queryParams","loading"]],template:function(s,l){1&s&&(t.nrm(0,"app-selected-list"),t.j41(1,"div",0),t.DNE(2,R,2,1,"div",1)(3,Y,3,0,"div",1),t.k0s()),2&s&&(t.R7$(2),t.Y8G("ngIf",l.dashboardLists),t.R7$(),t.Y8G("ngIf",!l.browserConnection))},dependencies:[f.Sq,f.bT,E.d,C.c],styles:["*[_ngcontent-%COMP%]{color:#faebd7}"]})}}return o})()}];let P=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[m.iI.forChild(x),m.iI]})}}return o})(),$=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[f.MD,M.G,P]})}}return o})()}}]);